var SaveAction;(function(n){function lt(){}function pi(n,r){var v;if(f&&!Lib.CssClass.contains(f,t)&&Lib.CssClass.add(f,t),l&&sb_ct(l),v=n.parentElement,v&&i&&Lib.CssClass.contains(v,ar)){v.contains(i)||v.appendChild(i);it&&a(ei,c,it);it=sj_wf(vt,n);u(ei,c,it);i.style.transform="";var p=i.getBoundingClientRect().right,w=_w.innerWidth,y=p-w+8;y>0&&(i.style.transform="translateX(calc(-50% - "+y+"px))");Lib.CssClass.remove(i,ii);l=sb_st(h,r);u(_d,c,h);u(_d,tt,wi);e(k,o,"",!1,s,rt)}}function wi(n){n.key==="Escape"&&h()}function uu(){f&&!Lib.CssClass.contains(f,t)&&Lib.CssClass.add(f,t);p&&(fr(),Lib.CssClass.remove(p,t),e(k,o,"",!1,s,rt),li=bi([vr],function(){er();p&&Lib.CssClass.add(p,t)}))}function fu(){f&&!Lib.CssClass.contains(f,t)&&Lib.CssClass.add(f,t);y&&w&&(fr(),Lib.CssClass.remove(w,ci),Lib.CssClass.add(w,hi),Lib.CssClass.remove(y,t),u(si,c,h),e(k,o,"",!1,s,rt),ai=bi([oi],function(){er();y&&w&&(Lib.CssClass.remove(w,hi),Lib.CssClass.add(w,ci),sb_st(function(){Lib.CssClass.add(y,t)},yr))}))}function eu(){f&&!Lib.CssClass.contains(f,t)&&Lib.CssClass.add(f,t);g&&sb_ct(g);b&&(Lib.CssClass.remove(b,t),g=sb_st(h,pr),e(k,o,"",!1,s,rt))}function bi(n,t,i){function r(t){var i=sj_et(t),r=n.some(function(n){return sj_fa(i,n)!=null}),u=t.key==="Escape";(!r||u)&&f(t)}function f(n){t(n);i&&(a(_d,c,r),a(_d,ni,r),a(_d,tt,r))}if(i===void 0&&(i=!0),n!=null&&n.length!==0)return sb_st(function(){u(_d,c,r);u(_d,ni,r);u(_d,tt,r)},0),f}function h(){v.shouldShowModalOnSave?li():v.shouldShowBottomSheetOrDrawerOnSave?Lib.CssClass.contains(y,t)?(sb_ct(g),g=null,b&&Lib.CssClass.add(b,t)):(a(si,c,h),ai()):(sb_ct(l),l=null,a(_d,c,h),a(_d,tt,wi),i&&Lib.CssClass.add(i,ii))}function ou(n,t){v.shouldShowModalOnSave?uu():v.shouldShowBottomSheetOrDrawerOnSave&&st!==null?st.savCtrlHusbs!=="true"?(fu(),st.savCtrlHusbs="true"):eu():r(n,wt)===ti&&pi(n,t===!0||v.disableActionPopupAutoDismiss?fi:ht)}function ki(n){l&&sb_ct(l);l=sb_st(h,n)}function di(n){return _d.querySelectorAll("[".concat(d,"='").concat(n,"']"))}function su(n,t){var u;t===void 0&&(t=!0);var e=r(n,d),f=di(e),i=null;for(u=0;u<f.length;u++)if(i=r(f[u],kt),i&&i.length>0){try{i=JSON.parse(i)}catch(o){continue}t&&(i.specifier={collectionType:parseInt(r(f[u],sr),10)});break}return i}function hu(n,t){var i=gi[t];if(i)return t+":"+i+"="+n[i==="sid"?"entityId":i]}function ut(n,t){return{type:t,CustomData:"{}",MediaId:n.mid||n.entityId,PageUrl:n.purl,MediaUrl:n.murl,EntityId:n.entityId,collectionItemId:hu(n,t),collection:{}}}function tr(n,t){var r,i;if(t===void 0&&(t=!1),r=[],n.videos)r=n.videos.map(function(n){return ut(n,"video")});else if(n.entities)r=n.entities.filter(function(n){var t=n.intent;return t==="Recipe"}).map(function(n){return ut(n,"recipe")});else if(n.type)switch(n.type){case"entities":r=n.itemsMeta.map(function(n){return ut(n,"recipe")});break;case"videos":r=n.itemsMeta.map(function(n){return ut(n,"video")})}return i={collectionItemType:"all"},i.specifier=n.specifier,n.videos&&(i.videos=n.videos),n.images&&(i.image=n.images),n.entities&&(i.entities=n.entities),t?i.itemReferences=r:(i.targetCollection={predefinedCollection:n.specifier?nr[n.specifier.collectionType]:null},i.items=r),i}function cu(n){n&&r(n,et)===ot&&(v.shouldShowModalOnSave||v.shouldShowBottomSheetOrDrawerOnSave||pi(n,ht))}function nt(n,t){for(var i,f=di(n),u=0;u<f.length;u++)if(i=f[u],i){var e=i.querySelector(hr),o=i.querySelector(cr),s=t?locStrings.remove:locStrings.save;e&&(e.innerHTML=t?SaveSvgIcon.savedIcon:SaveSvgIcon.saveIcon);o&&(o.innerHTML=s);r(i,dt)&&yt(i,dt,s);yt(i,et,t?ot:"0")}}function lu(n){var t=_G.SID,i;return(t||typeof sj_cook=="undefined"||(t=sj_cook.get("_SS","SID")),t)?(i=n.indexOf("?"),i==-1?n+"?sid="+t:n+"&sid="+t):n}function au(n,t,i){var r=sj_gx();n=lu(n);r.onreadystatechange=function(){if(r.readyState==4){var t=null,u=r.status,n=r.response;if(u==200&&(n===null||n===void 0?void 0:n.length))try{t=JSON.parse(n)}catch(f){return}i(t)}};r.open("POST",n,!0);r.setRequestHeader("Content-type","application/json");r.send(JSON.stringify(t))}function vt(n,t){var h=r(n,d),i=r(n,et)===ot,u=i?kr:br;e(gr,o,"",!1,s,u);var l="https://"+location.host+yi+(i?"delete":"add"),f=tr(su(n),i),c="SaveAction";f&&(i?FavRequest.deleteItems(f,function(r){var e=i;r&&r.IsSuccess?rr(h,i,n,f,e,t,u):ir(e,n,u)},c):FavRequest.addItem(f,function(r){var e=i;r&&r.IsSuccess?rr(h,i,n,f,e,t,u):ir(e,n,u)},c))}function ir(n,t,i){sj_evt&&sj_evt.fire(n?ru:tu,t);e(at,o,"",!1,s,i)}function rr(n,t,i,r,u,f,c){var a,l;nt(n,!t);t?h():ou(i,f);sj_evt&&(sj_evt.fire(u?iu:nu,i),a=r.items||r.itemReferences,a&&(l=a[0],l&&sj_evt.fire(u?"onFavDel":"onFavAdd",l.MediaId,l.collectionItemId)));e(k,o,"",!1,s,c)}function vu(n,t){var f,v,h,c,l,a,y,i,u;if(!t||(f=r(t,kt),v=r(t,d),!f||f.length===0||!v))return null;c={};try{for(i=JSON.parse(f),u=0;u<ui.length;u++)if(l=ui[u],i.hasOwnProperty(l[0])){h=l[0];a=l[1];c[a]=i[h][0][a];y=c[a];ct[y]=r(t,d);break}}catch(p){e(at,o,"",!1,s,dr,wr,JSON.stringify(f))}if(h){for(i=null,u=0;u<n.length;u++)if(n[u].type===h){i=n[u];break}i||(i={type:h,saveIds:[],itemsMeta:[]},n.push(i));i.saveIds.push(v);i.itemsMeta.push(c)}}function yu(n){if(n&&n.length){var t="https://"+location.host+yi+"status";n.forEach(function(n){if(n.itemsMeta.length>0){var i=tr(n,!0);au(t,i,function(t){var r,i,u;if(t&&t.IsSuccess&&t.Result&&t.Result.length>0){for(r=n.saveIds,i=0;i<r.length;i++)(u=t.Result[i].Present,u)&&nt(r[i],!0);e(k,o,"",!1,s,vi)}else t&&t.isSuccess?nt(n.saveIds[0],!0):e(at,o,"",!1,s,vi)})}})}}function ur(){var f=_d.querySelectorAll(or),e=[],t,n,o;if(f){for(t=0;t<f.length;t++)if(n=f[t],n){if(r(n,bt)==="1")continue;yt(n,bt,"1");o=sj_wf(vt,n);u(n,c,o);typeof AccessibilityHelpers!="undefined"&&AccessibilityHelpers.activateButtonByKey(n,[13,32],sj_wf(vt,n,!0));i&&r(n,wt)===ti&&u(n,gt,sj_wf(cu,n));shouldUseAjaxToGetStatus==="true"&&vu(e,n)}yu(e);sj_evt.bind("onSaveAdd",function(n){var t=n[2];nt(ct[t],!0)});sj_evt.bind("onSaveDel",function(n){var t=n[2];nt(ct[t],!1)})}i?(u(i,gt,sj_wf(ki,fi),!0),u(i,lr,sj_wf(ki,ht),!0)):p?_d.body.appendChild(p):y&&b&&(_d.body.appendChild(y),_d.body.appendChild(b))}function r(n,t){return n?n.getAttribute(t):null}function yt(n,t,i){n&&n.setAttribute(t,i)}function fr(){n.reversiblySetCssProperty(document.body,ri,-n.getBodyScrollTop()+"px");Lib.CssClass.add(document.body,"body_stop-page-scrolling")}function er(){var t=document.body.style.top;n.revertCssProperty(document.body,ri);Lib.CssClass.remove(document.body,"body_stop-page-scrolling");t!=null&&t!==""&&n.setBodyScrollTop(-parseInt(t,10))}function pu(){try{return _w.localStorage}catch(n){return null}}function wu(n,t,i){var r=n.style[t];r!=null&&r!==""&&n.setAttribute(ft+t,r);n.style[t]=i}function bu(n,t){var i=n.getAttribute(ft+t);n.style[t]=i!=null&&i!==""?i:null;n.removeAttribute(ft+t)}function ku(){return window.pageYOffset||document.documentElement!=null&&document.documentElement.scrollTop||document.body.scrollTop||0}function du(n){document.documentElement!=null&&(document.documentElement.scrollTop=n);document.body.scrollTop=n}var pt,gi,nr,ft;(function(n){n.AddItems="addItems";n.DeleteItems="deleteItems";n.GetStatus="getStatus"})(pt||(pt={}));var or="[data-type='saveAction']",d="data-saveId",et="data-isSaved",wt="data-promoted",bt="data-initialized",sr="data-colltype",kt="data-itemmeta",hr=".actIconSvg",cr=".actionlabel,.actLabel",dt="title",t="b_hide",lr="mouseout",gt="mouseenter",c="click",ni="focusin",tt="keydown",ar="sav-ctrl",ti="1",ot="1",ii="sav-ctrl-vis-hide",ri="top",u=sj_be,a=sj_ue,st=pu(),v=_w.saveActionConfigs||{shouldShowModalOnSave:!1,shouldShowBottomSheetOrDrawerOnSave:!1,disableActionPopupAutoDismiss:!1},ui=[["webresults","purl"],["entities","entityId"],["videos","mid"],["images","cid"]],l,fi=99999,ht=3e3,i=_ge("sav-ctrl-flyout"),ei=i?i.querySelector(".sav-ctrl__flyout-remove"):null,it=null,f=_ge("crtAct_tlTp"),vr=".sav-ctrl-modal__window",p=_qs(".sav-ctrl-modal__wrapper"),oi=".sav-ctrl-bottom-sheet__window",w=_qs(oi),y=_qs(".sav-ctrl-bottom-sheet__wrapper"),yr=350,si=_qs(".sav-ctrl-bottom-sheet__dismiss-button"),hi="sav-ctrl-bottom-sheet__animate-in",ci="sav-ctrl-bottom-sheet__animate-out",g,pr=2800,b=_qs(".sav-ctrl-drawer"),li=lt,ai=lt,ct={};var e=Log&&Log.Log?Log.Log:lt,o="SaveCtrl",s="Meta",wr="Value",br="Save",kr="Remove",vi="GetStatus",dr="GetStatusItemMeta",rt="ShowFlyout",gr="Click",k="Success",at="Failure",nu="Save_Success",tu="Save_Fail",iu="Remove_Success",ru="Remove_Fail",yi="/mysaves/collections/items/";n.hideSaveConfirmation=h;gi={video:"mid",image:"cid",recipe:"sid"};nr={2:"VideoWatchLater",13:"RecipeDefault"};u(_w,"load",ur);sj_evt&&sj_evt.bind("ajax.load",ur);ft="data-old-style-";n.reversiblySetCssProperty=wu;n.revertCssProperty=bu;n.getBodyScrollTop=ku;n.setBodyScrollTop=du})(SaveAction||(SaveAction={}))